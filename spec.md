# Plantasia — Product Specification v2

## Vision

**Plantasia** — приложение для планирования ротации растений в ограниченном пространстве.

Вдохновлено альбомом Mort Garson "Mother Earth's Plantasia" (1976) — тёплая электронная музыка для растений и людей, которые их любят.

---

## Problem Statement

> Я выращиваю растения и у меня есть коллекция семян и клонов. Пространство ограничено — один или несколько тентов/комнат с фиксированным количеством мест.
>
> Мне нужно обеспечить ротацию: пока одни растения цветут, другие должны расти на веге, а третьи — только проращиваться.
>
> **Но я не могу рассчитать:**
> - Когда переводить растения в цвет, чтобы освободить место вовремя?
> - Когда высаживать новые, чтобы они были готовы занять место после харвеста?
> - Сколько растений я реально могу вести параллельно?

**Plantasia решает эту проблему** — показывает временную шкалу всех растений и помогает спланировать ротацию так, чтобы пространство использовалось максимально эффективно. И бонусом прогнозирует сколько шишек будет на выходе.

---

## Core Concept

### Ячейка (Cell) — единица пространства

Всё пространство делится на **ячейки**. Одна ячейка = одно стандартное посадочное место.

Растение может занимать:
- **1 ячейка** — стандартный куст
- **2 ячейки** — крупное растение
- **4 ячейки** — очень большой куст


### Таймлайн — ключ к планированию

Каждое растение имеет предсказуемый жизненный цикл:
```
Проращивание → Рассада → Вегетация → Цветение → Харвест
    ~7 дней     ~14 дней   ~30 дней    ~60 дней  
```

Зная дату старта и характеристики сорта, можно рассчитать:
- Когда растение нужно перевести в цвет
- Когда ожидать харвест
- Когда освободится место

---

## MVP Scope (v1)

### Включено в MVP

#### Canvas & Toolbox
| ID | User Story |
|----|------------|
| C1 | Выбирать инструмент в Toolbox (Select, Space, Plant, Erase) |
| C2 | Масштабировать и панорамировать холст |
| C3 | Видеть все пространства и растения на одном холсте |

#### Пространства (инструмент Space)
| ID | User Story |
|----|------------|
| S1 | Выделить область на холсте → создать пространство |
| S2 | Изменить размер пространства перетаскиванием края |
| S3 | Переименовать пространство в Inspector |
| S4 | Удалить пространство (инструмент Erase или в Inspector) |

#### Инвентарь
| ID | User Story |
|----|------------|
| I1 | Добавить семена в инвентарь (сорт + количество) |
| I2 | Видеть инвентарь при выборе инструмента Plant |
| I3 | Выбрать семена/клоны из инвентаря для посадки |
| I4 | Видеть оставшееся количество семян |

#### Растения (инструмент Plant)
| ID | User Story |
|----|------------|
| P1 | Кликнуть на ячейку → посадить выбранное семя/клон |
| P2 | Провести по ячейкам → посадить несколько растений ("рассыпать") |
| P3 | Видеть код растения (GRZ-1) на ячейке |
| P4 | Перемещать растение drag & drop (инструмент Select) |
| P5 | Указать размер растения (1 / 2 / 4 ячейки) в Inspector |
| P6 | Менять стадию роста в Inspector |
| P7 | Видеть текущий день роста |
| P8 | Видеть предполагаемые даты (цветение, харвест) |
| P9 | Удалить растение (инструмент Erase или в Inspector) |

#### Таймлайн
| ID | User Story |
|----|------------|
| T1 | Переключиться в режим Timeline |
| T2 | Видеть все растения на временной шкале (Gantt) |
| T3 | Видеть маркер "сегодня" |
| T4 | Видеть предполагаемый срок до харвеста для каждого растения |
| T5 | Навигация по времени (вперёд / назад / сегодня) |

#### Сорта
| ID | User Story |
|----|------------|
| ST1 | Создать сорт с названием, аббревиатурой и днями цветения |
| ST2 | Просматривать список сортов |
| ST3 | Редактировать сорт |
| ST4 | Удалить сорт |

---

## UI Paradigm: Canvas + Toolbox

### Ключевая идея

Интерфейс — это **интерактивный холст** в стиле Minecraft: выбрал инструмент → тапнул/зажал на холсте → применил. Минимум UI-элементов, максимум прямого взаимодействия.

**Референсы:** Minecraft (hotbar + tap to place), SimCity (zoning tools)

### Два ракурса одного 3D-пространства

Данные существуют в трёх измерениях: **X** (горизонталь), **Y** (вертикаль), **Time** (время).

Кнопка **[TIME]** переключает ракурс:

```
SPACE VIEW (вид сверху)              TIME VIEW (вид сбоку)
        X-Y плоскость                    Cells-Time плоскость

         Y ↑                                    TIME ↑
           │                                         │  future
     ┌─────┼─────┬─────┐                   ┌───┬───┬───┬───┬───┐
     │ GRZ │     │     │                   │   │▓▓▓│   │   │   │
     │ -1  │ AFG │     │                   │▓▓▓│▓▓▓│   │   │   │
     ├─────┤ -4  ├─────┤    ══[TIME]══►    │▓▓▓│▓▓▓│░░░│░░░│   │
     │     │     │     │                   │▓▓▓│▓▓▓│░░░│░░░│   │
     ├─────┴─────┼─────┤                ───│GRZ│AFG│AFG│AFG│   │← today
     │           │ AFG │                   │-1 │-4 │-2 │-3 │   │
     │           │ -3  │                   └───┴───┴───┴───┴───┘
     │           ├─────┤                     │   │   │   │   │
     │           │ AFG │                  занятые        пустая
     │           │ -2  │                  ячейки         ячейка
     │           ├─────┤                                   ↓
     │           │ AFG │                          (можно запланировать
     │           │ -1  │                           растение в future)
     └───────────┴─────┘
           └────────► X                  └────────► Cells (все ячейки в ряд)
```

**Ключевое:**
- **Каждая ячейка** (включая пустые) = колонка в Time View
- Растения = вертикальные полосы, растущие вверх по времени
- Запланированные растения (startedAt > today) видны в Time View, но не в Space View
- Горизонтальная линия "today" разделяет прошлое и будущее

### Жесты (Minecraft-стиль)

| Жест | Без инструмента | С инструментом |
|------|-----------------|----------------|
| **Tap** | Выделить объект → Inspector | Применить инструмент |
| **Long press + drag** | Перетащить объект | Применить к области ("рассыпать") |
| **Pinch** | Zoom in/out | Zoom in/out |
| **Two-finger drag** | Pan холста | Pan холста |

### Hotbar (нижняя панель)

Всегда видна внизу экрана. Содержит инструменты и инвентарь:

```
┌─────────────────────────────────────────────────────────────────┐
│  [▢]   [GRZ×5] [WED×3] [GSC×2] [   ]   [✕]    ···    [⚙]       │
│ Space   Seeds (inventory slots)         Erase        Settings   │
└─────────────────────────────────────────────────────────────────┘
     │         │                            │
     │         └── выбрать = "взять в руку" │
     │             tap на ячейку = посадить │
     │                                      │
     └── выбрать = режим рисования          └── выбрать = режим удаления
         drag по ячейкам = создать Space        tap на объект = удалить
```

**Добавление семян:** tap на пустой слот → форма добавления (strain + quantity)

### Inspector (popup над объектом)

При tap на объект (без активного инструмента) появляется popup:

```
        ┌─────────────────┐
        │ GRZ-1           │
        │ Grizzly Purple  │
        │ Day 24 · Veg    │
        │ Harvest: ~45d   │
        │ ────────────────│
        │ Size: [1][2][4] │  ← количество ячеек
        │ Stage: [Veg ▼]  │
        │ [Delete]        │
        └────────┬────────┘
                 │
           ┌─────┴─────┐
           │   GRZ-1   │  ← ячейка на холсте
           └───────────┘
```

---

## Plant Visualization

### Аббревиатуры вместо эмодзи

Растения отображаются **текстовыми кодами** в моноширинном шрифте:

```
┌─────┬─────┬─────┬─────┐
│GRZ-1│GRZ-2│WED-1│     │
├─────┼─────┼─────┼─────┤
│GSC-1│GSC-2│     │     │
└─────┴─────┴─────┴─────┘
```

### Формат кода

```
[STRAIN_ABBR]-[NUMBER]

Примеры:
- GRZ-1  (Grizzly Purple #1)
- WED-2  (Wedding Cake #2)
- GSC-1  (Girl Scout Cookies #1)
- BLD-3  (Blue Dream #3)
```

**Правила генерации аббревиатуры:**
1. Берём первые буквы слов в названии сорта (не символы!)
2. Максимум 3-4 буквы
3. "Grizzly Purple" → GRP или GRZ
4. "Wedding Cake" → WED
5. "OG Kush" → OGK
6. Если сорт не указан → PLT (Plant)

**Пользователь может изменить аббревиатуру вручную.**

### Визуальные индикаторы стадии

Цвет фона или рамки ячейки показывает стадию:

| Стадия | Цвет | Пример |
|--------|------|--------|
| Germinating | Светло-коричневый | `[GRZ-1]` на бежевом |
| Seedling | Светло-зелёный | `[GRZ-1]` на салатовом |
| Vegetative | Зелёный | `[GRZ-1]` на зелёном |
| Flowering | Фиолетовый | `[GRZ-1]` на пурпурном |
| Harvested | Серый | `[GRZ-1]` на сером |

---

## User Flow (MVP)

### Space View (основной режим)

```
┌─────────────────────────────────────────────────────────────────────┐
│  PLANTASIA                                              [TIME ⏱]    │
│─────────────────────────────────────────────────────────────────────│
│                                                                     │
│                         C A N V A S                                 │
│                                                                     │
│      ┌───────────────────────────────┐                             │
│      │ TENT 1                        │                             │
│      │ ┌─────┬─────┬─────┬─────┐    │                             │
│      │ │GRZ-1│     │     │     │    │    Tap на ячейку:           │
│      │ │ ▓▓▓ │ AFG │     │     │    │    - пустая → посадить      │
│      │ ├─────┤ -4  ├─────┼─────┤    │    - занятая → Inspector    │
│      │ │     │ ▓▓▓ │     │     │    │                             │
│      │ ├─────┴─────┼─────┼─────┤    │    Long press + drag:       │
│      │ │           │AFG-3│     │    │    - перетащить растение    │
│      │ │           ├─────┤     │    │                             │
│      │ │           │AFG-2│     │    │                             │
│      │ │           ├─────┤     │    │                             │
│      │ │           │AFG-1│     │    │                             │
│      │ └───────────┴─────┴─────┘    │                             │
│      └───────────────────────────────┘                             │
│                                                                     │
├─────────────────────────────────────────────────────────────────────┤
│  [▢]   [GRZ×5] [WED×3] [GSC×2] [   ]   [✕]              [⚙]        │
│ Space   ─────── inventory ───────     Erase            Settings     │
└─────────────────────────────────────────────────────────────────────┘
```

### Time View (нажали [TIME])

```
┌─────────────────────────────────────────────────────────────────────┐
│  PLANTASIA                                             [SPACE 📍]   │
│─────────────────────────────────────────────────────────────────────│
│                                                                     │
│     TIME ↑        GRZ-1  AFG-4  AFG-2  AFG-3  (empty)              │
│          │        ┌────┬──────┬──────┬──────┬──────┐               │
│   future │        │    │ ░░░░ │      │      │      │  ← planned    │
│          │        │    │ ░░░░ │      │      │      │               │
│          │        │ ▓▓ │ ▓▓▓▓ │      │      │      │               │
│          │        │ ▓▓ │ ▓▓▓▓ │ ░░░░ │ ░░░░ │      │               │
│   ───────┼────────│ ▓▓ │ ▓▓▓▓ │ ░░░░ │ ░░░░ │      │── today ──   │
│          │        │ ▓▓ │ ▓▓▓▓ │ ▓▓▓▓ │ ▓▓▓▓ │      │               │
│          │        │ ▓▓ │ ▓▓▓▓ │ ▓▓▓▓ │ ▓▓▓▓ │      │               │
│     past │        │ ▓▓ │ ▓▓▓▓ │ ▓▓▓▓ │ ▓▓▓▓ │      │               │
│          │        │ ▓▓ │      │ ▓▓▓▓ │ ▓▓▓▓ │      │               │
│          ↓        └────┴──────┴──────┴──────┴──────┘               │
│                     │                          │                    │
│                  занятые                    пустая                  │
│                  ячейки                    (tap = запланировать)    │
│                                                                     │
├─────────────────────────────────────────────────────────────────────┤
│  [◀ -7d]  [Today]  [+7d ▶]              Zoom: [−] ══● [+]          │
└─────────────────────────────────────────────────────────────────────┘

Легенда:
▓▓ = прошлое (растение уже росло)
░░ = будущее (прогноз / план)
```

### Планирование в Time View

В Time View можно:
1. **Tap на пустую колонку в future** → запланировать растение на эту дату
2. **Drag полосу растения вверх/вниз** → изменить startedAt
3. **Видеть конфликты** → если два растения претендуют на одну ячейку в одно время

---

## Data Model (Simplified)

```
Space
  - id: UUID
  - name: String
  - originX: Int              // позиция на глобальном холсте
  - originY: Int
  - gridWidth: Int (1-10)
  - gridHeight: Int (1-10)
  - plants: [Plant]

Plant
  - id: UUID
  - code: String              // "GRZ-1" — авто или вручную
  - strain: Strain?
  - generation: seed | clone
  - stage: germinating | seedling | vegetative | flowering | harvested
  - size: 1 | 2 | 4 (cells)   // минимум 1 ячейка
  - gridX: Int                // позиция внутри Space (левый верхний угол)
  - gridY: Int
  - startedAt: Date
  - space: Space

Strain
  - id: UUID
  - name: String              // "Grizzly Purple"
  - abbreviation: String      // "GRZ" — авто или вручную
  - floweringDays: Int        // default 60
  - vegDays: Int              // default 30

Seed (Inventory)
  - id: UUID
  - strain: Strain
  - quantity: Int
  - isClone: Bool             // false = seed, true = clone
```

---

## Design Direction

### Aesthetic: 70s Synthesizer

Эстетика винтажных синтезаторов 70-х.

- **Тёмный фон** — глубокий тёмно-синий (#1A1A2E)
- **Тёплые акценты** — приглушённый зелёный, оранжевый, бирюзовый
- **Моноширинный шрифт** — для кодов и дат
- **Минимализм** — никаких карточек с тенями, плоский дизайн

---